#Taboola Recommendations API 2.0


## General
The Taboola Recommendations API is accessible by externally developed client implementations. The API specification is public, but access is controlled by using API keys that are registered to specific clients on a per-publisher account.


The API enables external developers to integrate Taboola recommendations into web pages or applications, that are using different technologies and may be running on different devices.


## Application Implementation Requirements
Applications using the Taboola Recommendations API must follow these specifications. Any deviation from these specifications could result in termination of the API key and the inability of the application to access the API. API Client Applications must implement the full specification, including event logging.


To start using the API, request the following data elements from Taboola:


1. Taboola The publisher ID: The Application Publisher&#39;s IDin the Taboola system
2. API Key: A per-application API key


### Application API Keys
Access to the Taboola Recommendations API is controlled by per-application API keys. This means that if a publisher intends to use the Taboola Recommendations API in more than one application, Taboola will need to generate a different API key for each application.


API keys are comprised of a globally unique string of hexadecimal characters that are registered by Taboola. Each API key is associated with both the publisher account and the specific application / use case for which it was created.


#### Application API Key Liefecycle
Each key has the following life-cycle:


1. Development Key: Newly created keys are called Development keys and have several restrictions, including a concurrency restriction of up to five simultaneous users, and a usage restriction of up to 3,000 daily requests.
2. Production Key: For a key to become a Production Key, the application using it must be validated by Taboola. Production keys have no restrictions associated with them. F
3. Revoked Keys: Keys in any of the states can be revoked if they are misused, r upon client request.


## Transport, Request Origin, Caching and Cookies


The Taboola Recommendations API is implemented using HTTP transactions. Requests are sent using the POST HTTP method and responses are formatted as a JSON formatted string.


API requests must not be cached. Every view of a recommendations unit must be generated by its own API request, and that API request must be invoked not more than 30 minutesbefore the actual rendering of the recommendation module.


## URL Structure


The Taboola Recommendations API is accessed as a set of HTTP URLs that are invoked by a conforming HTTP/1.1 client. The URL that the client uses to call the API is sent as a JSON object and is formed as follows:


·       The base URL address is the protocol and host name. For example: &quot;http://api.taboola.com
·       Reference version. For example: 2.0
·       Format for the response. For example: JSON
·       Publisher&#39;s ID. For example &quot;publisher-demo
·       Method name being called as the path elements. For example: &quot;recommendations.notify-click
·       Any arguments that need to be passed to the call as query string parameters.


The format of the URL for calling the API is as follows:


```http://api.taboola.com/<protocol-version>/<format>/<publisher id in the Taboola system>/<method name>```


Example:


```http://api.taboola.com/2.0/json/publisher-demo/recommendations.get```


## Error Handling


Although Taboola servers have fail- safe layers that always try to return recommendations, even in cases of server errors, Taboola can not guarantee that a valid response will always be received. This is because network conditions could block the request or response. Therefore, it is strongly recommended that the application is able to handle cases where an error response is received, or when no recommendations are returned within a reasonable amount of time.


### Error codes
If an invalid request is sent to the API, Taboola returns one of the following errors:


#### 400 Bad Request
Invalid publisher, invalid URL path or missing required parameter


#### 401 Unauthorized
Invalid API key
#### 429 Too Many Requests
Rate limit exceeded
#### Any 5xx type code
An unintended server error has occurred


## Requesting Recommendations


To retrieve recommendations to be displayed on a single module on the page, the application should call the recommendations.get&quot; method. The method  receives a Request JSON object describing the page where the recommendations is going to appear, and returns a Recommendation Response JSON Object.


Method Name: &quot;recommendations.get&quot;


### Request example:
```json
{
  "app": {
    "type": "DESKTOP",
    "apikey": "dfsdfdsfew4r345azsefa4e5455fr",
    "origin": "CLIENT",
    "consent": {
      "gdprApplies": true,
      "daisyBit": "rdftb…"
    },
    "user": {
      "session": "init",
      "realip": "24.126.139.0",
      "agent": "Mozilla%2F5.0+(Windows+NT+10.0%3B+Win64%3B+x64%3B+ServiceUI+13)+AppleWebKit%2F537.36+(KHTML%2C+like+Gecko)+Chrome%2F64.0.3282.140+Safari%2F537.36+Edge%2F17.17134",
      "device": "14A7B4BB0B5B63781A90BE1B0F5B6019"
    },
    "source": {
      "type": "HOME",
      "id": "Homepage+-+en-us",
      "url": "https%3A%2F%2Fwww.example.com%2Fadv"
    },
    "view": {
      "id": "a558e7763d614902a3689c69b23c25a7"
    },
    "placements": [
      {
        "name": "DHP-river-1-1",
        "recCount": 1,
        "organicType": "THUMBNAIL",
        "thumbnail": {
          "width": 300,
          "height": 175
        }
      }
    ]
  }
}
```
### Request Objects


#### app
The app object contains app related data:


##### app.type
Type of application using the API **.**


Valid values
| MOBILE | Use for mobile apps |
| --- | --- |
| DESKTOP | Use for interactive desktop apps |
| STB | Use for apps running on set-top boxes |
| WEB | Use of web applications or AJAX web sites |
| ADDON | Use for browser add-ons / toolbars |
| EMAIL | Use for email clients |
##### app.appiKey
The API key that was provided by Taboola for the application


##### app.origin
Specifying client or S2S integration


##### app.consent
The app.consent object contains GDPR related fields


```json
"consent": {
  "gdprApplies":true,
  "daisyBit":"BOMqNnFOOUeoYABABBENAc-AAAAUV7_______9_3__7_9uz_Ov_q_ff_3nW0731P1A_r_Oz_iE76xzUoQ_FA"
}
```
##### consent.gdprApplies
Indicates whether the current request should be applied with GDPR rules
##### consent.daisyBit
The consent vector of the user, provided by a CMP (Consent Management Platform).


### user
The user object contains user related data.


```json
"user": {
    "session": "init",
    "realip": "24.126.139.0",
    "agent": "Mozilla%2F5.0+(Windows+NT+10.0%3B+Win64%3B+x64%3B+ServiceUI+13)+AppleWebKit%2F537.36+(KHTML%2C+like+Gecko)+Chrome%2F64.0.3282.140+Safari%2F537.36+Edge%2F17.17134",
    "device": "14A7B4BB0B5B63781A90BE1B0F5B6019"
}
```


#### user.session
Value should be init for the first request in a session or the session value from the response to the last _recommendations.get_ request in the session.


#### user.realIp
Masked real IP address of the client side request, with last class as 0. Required in case the request is sent through a server. Should be formatted as dotted decimal (i.e. 1.2.3.0)


#### user.agent
The user-agent (HTTP header) from the client side request.


#### user.device
The use's' device ID


### source
The source object contains data about the source (page) the recommendations will be displayed on


```json
"source": {
    "type": "HOME",
    "id": "Homepage+-+en-us",
    "url": "https%3A%2F%2Fwww.example.com%home"
}
```


### source.type
The type of the content the recommendations will be placed next to.


The following values are supported:


| VIDEO | When the recommendations are placed near a video |
| --- | --- |
| TEXT | When the recommendations are placed near a textual piece such as an article / story |
| PHOTO | When the recommendations are placed near a photo or gallery |
| HOME | When the recommendations are placed on the app entry (home) screen |
| SECTION | When the recommendations are placed on a screen representing a &quot;section front&quot; or &quot;topic&quot; |
| SEARCH | When the recommendations are placed on a search results page |


### source.id
The ID of the item for which the recommendations should be provided. Consult your Taboola Solutions Manager about which ID should be provided here for each type of content.


##### Constructing source.id
The page URL may be used as a source.id, to extract thee source ID from the page URL:


1. Remove the protocol (http / https) from the page URL
2. Remove the domain (e.g. [example](http://www.example.com/)[.com](http://www.example.com/)) from the page URL
3. Remove any url fragments (#...) from the page URL
4. Remove any query params except for &#39;p&#39; or &#39;id&#39; from the page URL
5. If the URL path ends with trailing &#39;\&#39;, remove it.


For example, if the URL is &quot;[https://](https://www.google.co.il/webhp?source=search_app)[www.example.com](http://www.example.com/)[/webhp?source=search\_app](https://www.google.co.il/webhp?source=search_app)&quot;


&quot;http://www.google.co.il/&quot; is removed and the source.id would be &quot;webhp?source=search\_app&quot;


#### source.url
A fully qualified (http:// or https://) publicly accessible URL that contains the content and/or metadata for the current source item (the piece of content the recommendations are going to be placed next to).


A URL value must be provided. If the page where the recommendations will be displayed does not have a URL, (for example, a mobile application), it is usually recommended to use your company website.


### view


The view object contains data regarding the current page view


```json
"view" {
        "id": "a558e7763d614902a3689c69b23c25a7",
        "auctionType": "AUCTION" | "TABOOLA"
  }
```


#### view.id 
An ID of a single page view, which is used by Taboola to aggregate different requests to the same page view in reporting, as well as to de-duplicate recommendations between multiple widgets on the same page view. Different requests should have the same view.id if they are displayed on the same view from the publisher POV.


The view.id is required to be unique only in the context of the same session, so there is no need to supply a globally unique view ID


### Placements
An array of requested placements objects


```json
"placements": [
    {
          "name": "CardItem",
          "recCount": 1,
          "organicType": "THUMBNAIL" | "VIDEO" | "ORGANIC_PHOTOVIDEO"| "TEXT"| "MIX" ,
          "thumbnail": {
            "width": 300,
            "height": 175
          }
    }
  ]
```




#### placement.name
A text string, uniquely identifying the placement of a widget using the recommendation&#39;s response in the application.


If provided, this will allow breaking down reporting, and specifically controlling the recommendations behavior for each placement (similar to Google AdSense custom channels). source.placement is supported for backward compatibility.


For example, if the application uses recommendations on both &quot;articles&quot; and blog posts, source.type on both pages would need to be &quot;text&quot;, but the &quot;placement&quot; on the former might be &quot;article&quot; and &quot;blog&quot; on the latter.


Another example – if the application places two recommendation modules on the video page, one below the player and one to the right, the placement parameter might be below player for the first and right rail for the second.


#### placement.recCount
A non-negative integer specifying how many recommendations are requested. The API will not return more recommendations than this. However, if there are not enough good quality recommendations to satisfy the request, fewer items might be returned.


rec.count is supported for backward compatibility.


#### placement.organicType
Type of recommended organic\* content to return. Note that this parameter does not influence the type of sponsored content returned – the mix of the sponsored content types is currently determined by a server side configuration.


rec.type is supported for backward compatibility


Valid values


| VIDEO | Only returns video content ( **default** ) |
| --- | --- |
| TEXT | Only returns  textual (stories) content |
| PHOTO | Only returns photo / galleries content |
| MIX | Returns a mix of several content types. The exact mix is determined by server side configuration. Different configurations can be used for different source.type and placement parameters. |


#### Placement.thumbnail.width and placement.thumbnail.height
The size (in pixels) of the thumbnails returned for recommendations. Both parameters (height and width) should either appear together or not appear at all.If the thumbnail size parameters are specified, the thumbnail will always preserve its original aspect ratio. It will be scaled to the required size, centered and cropped if needed. In addition, if the thumbnail contains an image of a  face, Taboola detects that face by default and ensures that it is contained within the generated thumbnail.


rec.thumbnail.width / rec.thumbnail.height are supported for backward compatibility


## Recommendations Response
The response for &quot;recommendations.get&quot; is a JSON formatted string that contains the generated response ID and a recommendations list. If an output.callback parameter is specified, the response is padded with a callback.


Session data given in the response entity should be used by all events related to this response entity content
Each recommendations list is linked to a response ID, which should be used by all events related to the recommendations list content


### Example
```json
{
  "user": {
    "session": "v2_572fe86bc76a7b6706a6eed6c9716e2b_be491aa7-84ce-4a18-a373-82cd4b3fddf2-tuct3630b64_1550519598_1550519598_CIi3jgYQ_LY9GJTrsdipsIWA9wEgASgDMOEBOJGkDkDb7Q9Isr0eULMGWABgAA"
  },
  "placements": [
    {
      "name": "test",
      "id": "__2c708196b94cedffe8218e5e07576a21__86b92c069e35db97d7f3bfe0c178be0a__~~V1~~132998966815835741~~o5oFtU1oFoxjmyUFr7p2483mjfTjJQBvh_x30MPmkd4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5rhLDGLNPfFt-5UaV0la4Fm33TnytqoLji3B_3FzFzO92Zf5CxYUKG5rHOtb3d8rUUdO9jvppuNqSEzCnVWjfBkNaeRkm8qbYuF8hs7Db6K0,~~V1~~-5069714791530198616~~suMH8Ar6xvIBT5zP4joNo6OPsjbn5gBlTAti0dquaa4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5o6E0B_KpVN6eK55gbyhDsZiI-L6vKYJFPV50B962qHhU-v4E-BGMdPVa1zc5hAbBLvD8r5DJnxRPNf0XqdxNV0NaeRkm8qbYuF8hs7Db6K0__text,text",
      "ui": "rest-api",
      "list": [
        {
          "thumbnail": [
            {
              "url": "http://images.taboola.com/taboola/image/fetch/f_jpg%2Cq_auto%2Ch_311%2Cw_207%2Cc_fill%2Cg_faces:auto%2Ce_sharpen/http%3A%2F%2Fcdn.taboola.com%2Flibtrc%2Fstatic%2Fthumbnails%2F70a4a462bb242c935466d28b823fee42.jpg",
              "width": 207,
              "height": 311
            }
          ],
          "description": "Superb.net offers Reliable Linux and Windows web hosting solutions for Small and Medium size businesses. Our web hosting plans are built on our custom platform to optimized for performance. #@",
          "type": "TEXT",
          "name": "Drupal Hosting Starting $0.16/day",
          "created": "Tue, 15 Jan 2019 00:34:52 UTC",
          "branding": "Superb Web Hosting",
          "duration": 0,
          "categories": [
            "tech"
          ],
          "views": 0,
          "is-dc": false,
          "id": "~~V1~~132998966815835741~~o5oFtU1oFoxjmyUFr7p2483mjfTjJQBvh_x30MPmkd4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5rhLDGLNPfFt-5UaV0la4Fm33TnytqoLji3B_3FzFzO92Zf5CxYUKG5rHOtb3d8rUUdO9jvppuNqSEzCnVWjfBkNaeRkm8qbYuF8hs7Db6K0",
          "origin": "SPONSORED",
          "url": "http://api.taboola.com/2.0/json/betterbytheminute/recommendations.notify-click?app.type=email&app.apikey=faae74d77ed5cd60844ed42faefc3463&response.id=__2c708196b94cedffe8218e5e07576a21__86b92c069e35db97d7f3bfe0c178be0a&response.session=v2_572fe86bc76a7b6706a6eed6c9716e2b_be491aa7-84ce-4a18-a373-82cd4b3fddf2-tuct3630b64_1550519598_1550519598_CIi3jgYQ_LY9GJTrsdipsIWA9wEgASgDMOEBOJGkDkDb7Q9Isr0eULMGWABgAA&item.id=%7E%7EV1%7E%7E132998966815835741%7E%7Eo5oFtU1oFoxjmyUFr7p2483mjfTjJQBvh_x30MPmkd4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5rhLDGLNPfFt-5UaV0la4Fm33TnytqoLji3B_3FzFzO92Zf5CxYUKG5rHOtb3d8rUUdO9jvppuNqSEzCnVWjfBkNaeRkm8qbYuF8hs7Db6K0&item.type=text&sig=3b84f7432d30ffd2418e9174038d9a4f31fd1d9a0b21&redir=https%3A%2F%2Fwww.superb.net%2Fweb-hosting%3Futm_source%3Dtaboola%26utm_medium%3Dreferral"
        },
        {
          "thumbnail": [
            {
              "url": "http://images.taboola.com/taboola/image/fetch/f_jpg%2Cq_auto%2Ch_311%2Cw_207%2Cc_fill%2Cg_faces:auto%2Ce_sharpen/https%3A%2F%2Filikegermany.com%2Fwp-content%2Fuploads%2F2017%2F11%2FZwiebelkuchen-620x350.png",
              "width": 207,
              "height": 311
            }
          ],
          "type": "TEXT",
          "name": "Zwiebelkuchen",
          "created": "Fri, 30 Mar 2018 01:06:27 UTC",
          "branding": "I Like Germany",
          "duration": 0,
          "categories": [
            "travel"
          ],
          "views": 0,
          "is-dc": false,
          "id": "~~V1~~-5069714791530198616~~suMH8Ar6xvIBT5zP4joNo6OPsjbn5gBlTAti0dquaa4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5o6E0B_KpVN6eK55gbyhDsZiI-L6vKYJFPV50B962qHhU-v4E-BGMdPVa1zc5hAbBLvD8r5DJnxRPNf0XqdxNV0NaeRkm8qbYuF8hs7Db6K0",
          "origin": "SPONSORED",
          "url": "http://api.taboola.com/2.0/json/betterbytheminute/recommendations.notify-click?app.type=email&app.apikey=faae74d77ed5cd60844ed42faefc3463&response.id=__2c708196b94cedffe8218e5e07576a21__86b92c069e35db97d7f3bfe0c178be0a&response.session=v2_572fe86bc76a7b6706a6eed6c9716e2b_be491aa7-84ce-4a18-a373-82cd4b3fddf2-tuct3630b64_1550519598_1550519598_CIi3jgYQ_LY9GJTrsdipsIWA9wEgASgDMOEBOJGkDkDb7Q9Isr0eULMGWABgAA&item.id=%7E%7EV1%7E%7E-5069714791530198616%7E%7EsuMH8Ar6xvIBT5zP4joNo6OPsjbn5gBlTAti0dquaa4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5o6E0B_KpVN6eK55gbyhDsZiI-L6vKYJFPV50B962qHhU-v4E-BGMdPVa1zc5hAbBLvD8r5DJnxRPNf0XqdxNV0NaeRkm8qbYuF8hs7Db6K0&item.type=text&sig=53ecfc943e2c5033e5524c5e226bf841056eed0db138&redir=https%3A%2F%2Filikegermany.com%2Fgerman-food%2Fzwiebelkuchen%2F%3Futm_source%3Dtaboola%26utm_medium%3Dreferral"
        }
      ],
      "events": {
        "available": "http://api.taboola.com/2.0/json/betterbytheminute/recommendations.notify-available?app.type=email&app.apikey=faae74d77ed5cd60844ed42faefc3463&response.id=__2c708196b94cedffe8218e5e07576a21__86b92c069e35db97d7f3bfe0c178be0a__%7E%7EV1%7E%7E132998966815835741%7E%7Eo5oFtU1oFoxjmyUFr7p2483mjfTjJQBvh_x30MPmkd4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5rhLDGLNPfFt-5UaV0la4Fm33TnytqoLji3B_3FzFzO92Zf5CxYUKG5rHOtb3d8rUUdO9jvppuNqSEzCnVWjfBkNaeRkm8qbYuF8hs7Db6K0%2C%7E%7EV1%7E%7E-5069714791530198616%7E%7EsuMH8Ar6xvIBT5zP4joNo6OPsjbn5gBlTAti0dquaa4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5o6E0B_KpVN6eK55gbyhDsZiI-L6vKYJFPV50B962qHhU-v4E-BGMdPVa1zc5hAbBLvD8r5DJnxRPNf0XqdxNV0NaeRkm8qbYuF8hs7Db6K0__text%2Ctext&response.session=v2_572fe86bc76a7b6706a6eed6c9716e2b_be491aa7-84ce-4a18-a373-82cd4b3fddf2-tuct3630b64_1550519598_1550519598_CIi3jgYQ_LY9GJTrsdipsIWA9wEgASgDMOEBOJGkDkDb7Q9Isr0eULMGWABgAA&view.external-id=dsfasdfasdfasdf34234",
        "visible": "http://api.taboola.com/2.0/json/betterbytheminute/recommendations.notify-visible?app.type=email&app.apikey=faae74d77ed5cd60844ed42faefc3463&response.id=__2c708196b94cedffe8218e5e07576a21__86b92c069e35db97d7f3bfe0c178be0a__%7E%7EV1%7E%7E132998966815835741%7E%7Eo5oFtU1oFoxjmyUFr7p2483mjfTjJQBvh_x30MPmkd4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5rhLDGLNPfFt-5UaV0la4Fm33TnytqoLji3B_3FzFzO92Zf5CxYUKG5rHOtb3d8rUUdO9jvppuNqSEzCnVWjfBkNaeRkm8qbYuF8hs7Db6K0%2C%7E%7EV1%7E%7E-5069714791530198616%7E%7EsuMH8Ar6xvIBT5zP4joNo6OPsjbn5gBlTAti0dquaa4gADLX0sCLI84lvxeYoNVBXtEiVLHvk6BFwXvQihx-5o6E0B_KpVN6eK55gbyhDsZiI-L6vKYJFPV50B962qHhU-v4E-BGMdPVa1zc5hAbBLvD8r5DJnxRPNf0XqdxNV0NaeRkm8qbYuF8hs7Db6K0__text%2Ctext&response.session=v2_572fe86bc76a7b6706a6eed6c9716e2b_be491aa7-84ce-4a18-a373-82cd4b3fddf2-tuct3630b64_1550519598_1550519598_CIi3jgYQ_LY9GJTrsdipsIWA9wEgASgDMOEBOJGkDkDb7Q9Isr0eULMGWABgAA&view.external-id=dsfasdfasdfasdf34234"
      }
    }
  ]
}
```


## user


### user.session
Taboola session data. The value from the last request in a session should be saved and sent in every subsequent request or event notification. This value is not a fixed session ID and can change from request to request, so it is imperative to use the session data from the last request in a session.


### user.beacons
Request level beacons allow third party beacons for syncing using pixels and/or scripts. This can be used, for example, to sync users.


```json
{
    "beacons": [
              {
                "value": "https//partner1...",
                "type": "PIXEL"
              },
              {
                "value": "%3Cscript%20src%3D%22https%3A%...",
                "type": "VIDEO_TAG"
              }
        ]
```


#### beacons.value
A URL or JSON content to call or run.


#### beacons.type**


| PIXEL | A URL to be called over GET |
| --- | --- |
| SCRIPT | An encoded \&lt;script\&gt; tag to be decoded and added to the page DOM.| |
| VIDEO\_TAG | An encoded Javascript already wrapped in \&lt;script\&gt; tags.| |


## placements


```json
{
  "placements": [
    {
      "name": "DHP-river-1-1",
      "id": "__4102bdf90b2e779276c8b7d8b3b39…..",
      "events": {
        "available": "http://example.com/avail",
        "visible": "http://example.com/vis",
        "visibleTpan": "http://example.com/visx"
      },
      "ui": "rest-api",
      "list": [
        {
          "thumbnail": [
            {
              "url": "http://images.taboola.com…..",
              "width": 300,
              "height": 175
            }
          ],
          "type": "TEXT",
          "name": "Austell, Georgia Drivers Fuming Over New Rule",
          "created": "Thu, 12 Jul 2018 18:52:52 UTC",
          "branding": "QuoteWizard Insurance Quotes",
          "id": "~~V1~~-426882290692508…...",
          "origin": "SPONSORED",
          "url": "http://api.taboola.com/1.2/json/demo-pub/recomm…..",
          "disclosure": "//adchoices-link-per-advertiser.html",
          "beacons": [
            {
              "onEvent": "VISIBLE",
              "value": "…",
              "type": "PIXEL"
            },
            {
              "onEvent": "CLICK",
              "value": "…",
              "type": "PIXEL"
            },
            {
              "onEvent": "AVAILABLE",
              "value": "%3Cscript%20src%3D%22https%3A%2F%2Fz.moatads.comlay7….",
              "type": "SCRIPT"
            }
          ]
        }
      ]
    }
  ]
}
```




### placement.name
The name of the placement as it was specified in the request.


### placement.id
A unique Taboola recommendations ID. This ID should be saved and sent in each notification event connected to the recommendations.get request or per mapped recommendations chunk (recX) when using recommendations.get request.


### placement.events
The placement lifecycle events beacons. These will notify about different placement lifecycle events
```json
"events": {
      "available": "http://example.com/avail",
      "visible": "http://example.com/vis",
      "availableTpan": "http://example.com/availx",
      "visibleTpan": "http://example.com/visx",
      "clickTpan": "http://example.com/click"
  }
```
#### placement.events.available
Triggered from the browser when a Taboola placement is being rendered to the page


#### placement.events.visible
Triggered from the browser when a Taboola placement is visible on the page


### placement.ui
UI mode name as defined in Taboola internal mediation table. The UI is returned in case the Taboola system is configured to override the default UI (due to mediation, full page personalization or A/B testing) for the requested placement. The list of possible UI values should be agreed upon beforehand between Taboola and the publisher, and the client should have a function that renders the relevant UI according to the UI value in the response.


### placement.list
An array of recommended items.


```json
{
  "list": [
    {
      "thumbnail": [
        {
          "url": "http://images.taboola.com…..",
          "width": 300,
          "height": 175
        }
      ],
      "type": "TEXT",
      "name": "Austell, Georgia Drivers Fuming Over New Rule",
      "created": "Thu, 12 Jul 2018 18:52:52 UTC",
      "branding": "QuoteWizard Insurance Quotes",
      "id": "~~V1~~-426882290692508…...",
      "origin": "SPONSORED",
      "url": "http://api.taboola.com/1.2/json/demo-pub/recomm…..",
      "disclosure": "//adchoices-link-per-advertiser.html",
      "beacons": [
        {
          "onEvent": "VISIBLE",
          "value": "…",
          "type": "PIXEL"
        },
        {
          "onEvent": "CLICK",
          "value": "…",
          "type": "PIXEL"
        },
        {
          "onEvent": "AVAILABLE",
          "value": "%3Cscript%20src%3D%22https%3A%2F%2Fz.moatads.comlay7….",
          "type": "SCRIPT"
        }
      ]
    }
  ]
}
```


#### placement.list.thumbnail
list of thumbnails associated with the recommendation.
```json
{
    "thumbnail": [
                {
                  "url": "http://images.taboola.com…..",
                  "width": 300,
                  "height": 175
                }
    ]
}
```




##### placement.list.thumbnail.url
The URL for loading the thumbnail.


##### placement.list.thumbnail.width
The width of the image in pixels.


##### placement.list.thumbnail.height
The height of the image in pixels.


Note: The width and height fields are optional when a single thumbnail is returned in the list, but are guaranteed to be supplied with each thumbnail when multiple thumbnails are returned.


#### placement.list.type
Type of recommended item.


| VIDEO | Video content |
| --- | --- |
| TEXT | Textual (stories) content |
| PHOTO | Photo/ galleries content.| |


#### placement.list.name
Name / Title of the recommended item.


#### placement.list.created
Date and time the item was created / published, in RFC 1123 format.


#### placement.list.branding
Branding text for the network/sponsored item. Sponsored recommendations must have this text displayed in a visible location within the recommendation (such as near or below the title).


Only for a Network/Sponsored Recommended (origin=&quot;sponsored&quot; or origin=&quot;network&quot;)


#### placement.list.id
Identifier of the recommended item. This ID should be sufficient for the application to know how to play or present the recommendation when clicked.


#### placement.list.origin
An indication on the origin of the content – whether it is organic (from your own site), in-network (from other sites within your network) or sponsored (from other content providers that pay Taboola to distribute their content).


Valid values are:


ORGANIC: Organic content ( default )
SPONSORED: Sponsored content
NETWORK: From other sites within your network
NATIVE\_AD: Native content


#### placement.list.url
Click URL. To be used when the user clicks on the items image / title / call to action button


#### placement.list.disclosure
Disclosure URL used as the Adchoices icon link presented on the relevant item thumbnail, during mouseover.


#### placement.list.beacons
third-party trackers are objects which will be included in the Recommendations API response and need to be activated once their specified events occur.


```json
{
  "beacons": [
    {
      "onEvent": "VISIBLE",
      "value": "https://...",
      "type": "PIXEL"
    },
    {
      "onEvent": "CLICK",
      "type": "PIXEL",
      "value": "https://..."
    },
    {
      "onEvent": "AVAILABLE",
      "type": "SCRIPT",
      "value": "%3Cscript%20src%3D%22https%3A%2F%2Fz.moatads.comlay7…."
    }
  ]
}
```




##### placement.list.beacon.onEvent
The placement event in which the pixel or JS is triggered.


##### placement.list.beacon.type
Activation type:


PIXEL: AURL to be called on the event specified on onEvent
SCRIPT: An encoded \&lt;script\&gt; tag to be decoded and added the placement&#39;s placement DOM. This is added because many RTB partners now request support for JS Trackers


##### placement.list.beacon.value
A URL or JS content to call or run.


##### Events Tracker
Impression tracking URL, expected to return a 1x1 image pixel or 204 response. Can be fired upon impression, visible event, or click event.


##### JS Trackers
JavaScript impression tracker, where possible to implement (i.e. excluding DHP, NTP) . This is a valid Javascript already wrapped in \&lt;script\&gt; tags. It should be executed at impression time where it can be supported. Supported trackers include: JS Trackers from Moat, DoubleVerify or IntegralAdScience.


The following object will be returned in Taboola&#39;s response:
```json
{
  "onEvent": "AVAILABLE",
  "type": "SCRIPT",
  "value": "%3Cscript%20src%3D%22https%3A%2F%2Fz.moatads.com%2Ftabooladisplay734490699124%2Fmoatad.js%23moatClientLevel1%3D_ADVERTISER_%26moatClientLevel2%3D_CAMPAIGN_%26moatClientLevel3%3D_LINEITEM_%26moatClientLevel4%3D_CREATIVE_%26moatClientSlicer1%3D_SITE_%26moatClientSlicer2%3D_PLACEMENT_%22%20type%3D%22text%2Fjavascript%22%3E%3C%2Fscript%3E%0A "
}
```


The &#39;value&#39; portion will then be decoded and added to the placement&#39;s DOM element:
```html
<script src="https://z.moatads.com/tabooladisplay734490699124/moatad.js#moatClientLevel1=_ADVERTISER_&moatClientLevel2=_CAMPAIGN_&moatClientLevel3=_LINEITEM_&moatClientLevel4=_CREATIVE_&moatClientSlicer1=_SITE_&moatClientSlicer2=_PLACEMENT_" type="text/javascript">
</script>
```
# Recommendations Events API


## Click Notification


When the user selects a recommendation, and the recommended item is displayed directly by the app (without going through the URL), the application should send the &quot;notify-click&quot; event, passing the session from the response to the last request, and the ID of the actual response that corresponds to the selected recommendation, along with the id and type of the selected item


Method Name: ecommendations.notify-click


```
http://api.taboola.com/1.2/json/publisher-demo/recommendations.notify-click?app.type=mobile&amp;app.apikey=45345sedddfse455&amp;response.session=idfh2438u20rf29u9&amp;response.id=2345112123&amp;item.type=video&amp;item.id=678328755932
```




## Availability Notification
If the recommendation module is not displayed at the time of the request, the application sends a &quot;placement.available=false&quot; / &quot;placementX.available=false&quot; argument in the request. Later, when the recommendation module is displayed it sends a &quot;notify-available&quot; event, passing the session from the response to the last request, and the ID of the actual response that corresponds to the visible recommendations.


**Due to Taboola backend settings, do not cache a response for more than 30 minutes.**


## Visibility Notification


If the recommendation module is not visible to the user at the time of the request, the application sends a “placement.visible=false” / “placementX.visible=false” argument in the request. Later, it sends  a “notify-visible” event when the recommendation module is actually visible to the viewer, passing the session from the response to the last request, and the ID of the actual response that corresponds to the visible recommendations. This event should be sent after the available event was sent, unless “placement.available” / “placementX.available” was sent with “true”.
A module is considered visible if the center of the module appears in the viewer’s viewport for at least one second.


**A module is considered visible if the center of the module appears in the viewer&#39;s viewport for at least one second.**
```
http://api.taboola.com/1.2/json/publisher-demo/recommendations.notify-visible?app.type=mobile&amp;app.apikey=rwereere34er34523ee&amp;response.id=2345112123
```
## User Data API


ser data has great value to the Taboola ecosystem. In server-to-server integration, Taboola API requests will not have the same data as with client-to-server requests. Because some of this data is relevant for personalizing Taboola recommendations to optimize performance, and to provide this data for server-to-server integration, Taboola recommends adding a user ID sync API call.


### User Sync Event


In a server-to-server integrations, Taboola cannot get the Taboola user ID from the browser cookie. If the client side has access to the main browser, the user sync event can be used to get the Taboola user ID and then use it when asking for recommendations.


The Taboola user ID can be cached on the server side for up to one month, after which it must be refreshed.


The recommended flow:


1. When the page starts to load, check if a cached Taboola user ID value exists and is less than one month old
  1. 1.If there is no cached Taboola user ID, or the cached ID is too old,execute a user sync event from the client side and wait for its response
  2. 2.Get the user sync event response and extract the Taboola user ID
2. Send the recommendations.get request from the server, populating the user.id field with the relevant Taboola user ID


The Taboola server will now be able to better personalize the recommendations by using information about the user from the entire Taboola network.s


Method Name: &quot;user.sync&quot
Request Arguments


| **Name** | **Required / Optional** | **Type** | **Description** |
| --- | --- | --- | --- |
| app.type  | Required | String | Type of application using the API.Valid values:  same as the one that was sent in the &quot;recommendations.get&quot;call |
| app.apikey | Required | String | The API key that was provided by Taboola for the application |


###
##### User Sync Response
The response is the Taboola user ID as it set in the browser&#39;s cookie.
Example: **


{ &quot;user&quot;: { &quot;id&quot;: &quot;\&lt;value\&gt;&quot; } }